<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Date Calculator - Calculate days between dates and track absentee periods"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Date Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <script type="module">
      import React from 'https://esm.sh/react@18';
      import ReactDOM from 'https://esm.sh/react-dom@18';
      
      // Simple Date Calculator Component
      const { useState, useEffect, useCallback } = React;
      
      const DateCalculatorApp = () => {
        const [absenteePeriods, setAbsenteePeriods] = useState([
          { id: 1, startDate: '2021-10-16', endDate: '2021-11-14', days: 30 },
          { id: 2, startDate: '2022-05-13', endDate: '2022-06-19', days: 38 },
          { id: 3, startDate: '2022-07-30', endDate: '2022-08-08', days: 10 },
          { id: 4, startDate: '2022-11-26', endDate: '2022-12-26', days: 31 },
          { id: 5, startDate: '2023-03-29', endDate: '2025-07-15', days: 840 },
          { id: 6, startDate: '2025-07-15', endDate: '2025-07-15', days: 1 }
        ]);

        const [referenceDate, setReferenceDate] = useState('');
        const [calculations, setCalculations] = useState({
          totalAbsentDays: 0,
          totalAbsentYears: 0
        });

        // Calculate days between two dates
        const calculateDaysBetween = useCallback((startDate, endDate) => {
          if (!startDate || !endDate) return 0;
          
          const start = new Date(startDate);
          const end = new Date(endDate);
          
          if (end < start) return 0;
          
          const timeDiff = end.getTime() - start.getTime();
          const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;
          
          return daysDiff;
        }, []);

        // Update individual period days
        const updatePeriodDays = useCallback((id, startDate, endDate) => {
          const days = calculateDaysBetween(startDate, endDate);
          
          setAbsenteePeriods(prev => 
            prev.map(period => 
              period.id === id 
                ? { ...period, startDate, endDate, days }
                : period
            )
          );
        }, [calculateDaysBetween]);

        // Handle date input changes
        const handleDateChange = useCallback((id, field, value) => {
          const period = absenteePeriods.find(p => p.id === id);
          if (!period) return;

          const newStartDate = field === 'startDate' ? value : period.startDate;
          const newEndDate = field === 'endDate' ? value : period.endDate;

          updatePeriodDays(id, newStartDate, newEndDate);
        }, [absenteePeriods, updatePeriodDays]);

        // Calculate totals
        useEffect(() => {
          const totalAbsentDays = absenteePeriods.reduce((sum, period) => sum + period.days, 0);
          const totalAbsentYears = parseFloat((totalAbsentDays / 365.25).toFixed(2));

          setCalculations({
            totalAbsentDays,
            totalAbsentYears
          });
        }, [absenteePeriods]);

        // Set reference date to 5 years ago from today
        useEffect(() => {
          const today = new Date();
          const fiveYearsAgo = new Date(today.getFullYear() - 5, today.getMonth(), today.getDate());
          const fiveYearsAgoString = fiveYearsAgo.toISOString().split('T')[0];
          setReferenceDate(fiveYearsAgoString);
        }, []);

        return React.createElement('div', { className: 'max-w-4xl mx-auto p-6 bg-white min-h-screen' }, [
          // Header
          React.createElement('div', { className: 'mb-8', key: 'header' }, [
            React.createElement('h1', { className: 'text-3xl font-bold text-gray-800 mb-4', key: 'title' }, 'Date Calculator'),
            React.createElement('div', { className: 'bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6', key: 'ref-date' },
              React.createElement('p', { className: 'text-lg font-medium text-blue-800' }, 
                `5 years ago from today: ${referenceDate}`
              )
            )
          ]),

          // Absentee Periods
          React.createElement('div', { className: 'mb-8', key: 'periods' }, [
            React.createElement('h2', { className: 'text-2xl font-bold text-gray-800 mb-6', key: 'periods-title' }, 'Enter up to 6 Absentee Periods'),
            React.createElement('div', { className: 'space-y-4', key: 'periods-list' },
              absenteePeriods.map((period, index) => 
                React.createElement('div', { className: 'bg-gray-50 border border-gray-200 rounded-lg p-4', key: period.id }, 
                  React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-4 gap-4 items-end' }, [
                    React.createElement('div', { key: 'start' }, [
                      React.createElement('label', { className: 'block text-sm font-medium text-gray-600 mb-1' }, `Absentee ${index + 1} Start:`),
                      React.createElement('input', {
                        type: 'date',
                        value: period.startDate,
                        onChange: (e) => handleDateChange(period.id, 'startDate', e.target.value),
                        className: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                      })
                    ]),
                    React.createElement('div', { key: 'end' }, [
                      React.createElement('label', { className: 'block text-sm font-medium text-gray-600 mb-1' }, 'End:'),
                      React.createElement('input', {
                        type: 'date',
                        value: period.endDate,
                        onChange: (e) => handleDateChange(period.id, 'endDate', e.target.value),
                        className: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                      })
                    ]),
                    React.createElement('div', { className: 'text-center', key: 'days' }, [
                      React.createElement('div', { className: 'text-sm text-gray-600' }, 'Days:'),
                      React.createElement('div', { className: 'text-2xl font-bold text-blue-600' }, period.days)
                    ])
                  ])
                )
              )
            )
          ]),

          // Calculate Button
          React.createElement('div', { className: 'text-center mb-8', key: 'calc-btn' },
            React.createElement('button', {
              className: 'px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium',
              onClick: () => {}
            }, 'Calculate Actual Days')
          ),

          // Results
          React.createElement('div', { className: 'bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6', key: 'results' }, [
            React.createElement('h3', { className: 'text-xl font-bold text-gray-800 mb-4' }, 'Results'),
            React.createElement('div', { className: 'bg-white rounded-lg p-6 shadow-sm' }, [
              React.createElement('div', { className: 'text-lg font-bold mb-2' }, [
                React.createElement('div', { className: 'text-red-600 mb-2' }, 
                  `Total Absentee Days: ${calculations.totalAbsentDays} days (${calculations.totalAbsentYears} years)`
                ),
                React.createElement('div', { className: 'text-green-600' }, 
                  `Actual Days Present: ${Math.max(0, (calculateDaysBetween(referenceDate, new Date().toISOString().split('T')[0]) - calculations.totalAbsentDays))} days (${Math.max(0, ((calculateDaysBetween(referenceDate, new Date().toISOString().split('T')[0]) - calculations.totalAbsentDays) / 365.25)).toFixed(2)} years)`
                )
              ])
            ])
          ])
        ]);
      };

      // Render the app
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(DateCalculatorApp));
    </script>
  </body>
</html>
