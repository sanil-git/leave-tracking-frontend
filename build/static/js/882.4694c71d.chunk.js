/*! For license information please see 882.4694c71d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkleave_tracking_app=self.webpackChunkleave_tracking_app||[]).push([[882],{882:(e,r,s)=>{s.r(r),s.d(r,{default:()=>j});var a=s(43),t=s(459),l=s(784);const o=(0,l.A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),n=(0,l.A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var i=s(210);const d=(0,l.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),c=(0,l.A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var m=s(118),x=s(884);const u=(0,l.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var h=s(614),g=s(579);const b={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:8000":"https://leave-tracking-backend.onrender.com");function p(e){let{currentRole:r,userId:s,onRoleChange:l,allowedRoles:d}=e;const[c,m]=(0,a.useState)(!1),x=a.useRef(null);a.useEffect(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&m(!1)};if(c)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[c]);const u={employee:{label:"Employee",color:"bg-green-100 text-green-800",icon:(0,g.jsx)(t.A,{size:12})},manager:{label:"Manager",color:"bg-blue-100 text-blue-800",icon:(0,g.jsx)(o,{size:12})},admin:{label:"Admin",color:"bg-purple-100 text-purple-800",icon:(0,g.jsx)(n,{size:12})}};return(0,g.jsxs)("div",{className:"relative",ref:x,children:[(0,g.jsxs)("button",{onClick:()=>m(!c),className:"flex items-center space-x-2 px-3 py-1 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",title:"Click to change role",children:[u[r].icon,(0,g.jsx)("span",{className:"ml-1",children:u[r].label}),(0,g.jsx)("svg",{className:"ml-1 w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&(0,g.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:(0,g.jsxs)("div",{className:"py-1",children:[(0,g.jsx)("div",{className:"px-4 py-2 text-xs font-semibold text-gray-500 uppercase border-b border-gray-100",children:"Change Role"}),d.map(e=>(0,g.jsxs)("button",{onClick:()=>{return(a=e)!==r&&l(s,a),void m(!1);var a},disabled:e===r,className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center "+(e===r?"bg-gray-50 cursor-not-allowed opacity-50":"cursor-pointer"),children:[u[e].icon,(0,g.jsx)("span",{className:"ml-2",children:u[e].label}),e===r&&(0,g.jsx)(i.A,{size:12,className:"ml-auto text-green-600"})]},e))]})})]})}function y(e){let{user:r,onRoleChange:s}=e;return(0,g.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,g.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,g.jsx)("span",{className:"text-blue-600 font-semibold text-lg",children:r.name.charAt(0).toUpperCase()})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:r.name}),(0,g.jsx)("p",{className:"text-sm text-gray-600",children:r.email}),(0,g.jsxs)("p",{className:"text-xs text-gray-500",children:["Joined: ",new Date(r.createdAt).toLocaleDateString()]})]})]}),(0,g.jsx)("div",{className:"flex items-center space-x-3",children:(0,g.jsx)(p,{currentRole:r.role,userId:r._id,onRoleChange:e=>s(r._id,e),allowedRoles:["employee","manager","admin"]})})]})})}const j=function(){const[e,r]=(0,a.useState)([]),[s,l]=(0,a.useState)(!0),[i,p]=(0,a.useState)(null),[j,f]=(0,a.useState)(""),[N,v]=(0,a.useState)(""),[w,k]=(0,a.useState)(!1),C=localStorage.getItem("token");(0,a.useEffect)(()=>{A()},[]);const A=async()=>{try{l(!0),p(null);const e=await fetch(`${b}/api/admin/users`,{headers:{Authorization:`Bearer ${C}`}});if(e.ok){const s=await e.json();r(s.users),p(null)}else{const r=await e.json();p(r.error||"Failed to fetch users")}}catch(e){p("Network error. Please try again."),console.error("Fetch users error:",e)}finally{l(!1)}},S=e.filter(e=>{const r=e.name.toLowerCase().includes(j.toLowerCase())||e.email.toLowerCase().includes(j.toLowerCase()),s=!N||e.role===N;return r&&s});return(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Admin Panel"}),(0,g.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage users, roles, and system settings"})]}),(0,g.jsx)("div",{className:"flex items-center space-x-3",children:(0,g.jsxs)("div",{className:"text-right",children:[(0,g.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Total Users"}),(0,g.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.length})]})})]})}),(0,g.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,g.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,g.jsxs)("div",{className:"flex-1 relative",children:[(0,g.jsx)("label",{htmlFor:"user-search",className:"sr-only",children:"Search users by name or email"}),(0,g.jsx)(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,g.jsx)("input",{id:"user-search",name:"user-search",type:"text",placeholder:"Search users by name or email...",value:j,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,g.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,g.jsx)(c,{className:"text-gray-400",size:20}),(0,g.jsx)("label",{htmlFor:"role-filter",className:"sr-only",children:"Filter by role"}),(0,g.jsxs)("select",{id:"role-filter",name:"role-filter",value:N,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,g.jsx)("option",{value:"",children:"All Roles"}),(0,g.jsx)("option",{value:"admin",children:"Admin"}),(0,g.jsx)("option",{value:"manager",children:"Manager"}),(0,g.jsx)("option",{value:"employee",children:"Employee"})]})]})]})}),(0,g.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,g.jsxs)("button",{onClick:()=>f(""),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[(0,g.jsx)(m.A,{className:"text-gray-400 mr-2",size:20}),(0,g.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Show All Users"})]}),(0,g.jsxs)("button",{onClick:()=>v("admin"),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 hover:bg-purple-50 transition-colors",children:[(0,g.jsx)(n,{className:"text-gray-400 mr-2",size:20}),(0,g.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Show Admins Only"})]}),(0,g.jsxs)("button",{onClick:()=>v("manager"),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[(0,g.jsx)(o,{className:"text-gray-400 mr-2",size:20}),(0,g.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Show Managers"})]}),(0,g.jsxs)("button",{onClick:()=>v("employee"),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-green-400 hover:bg-green-50 transition-colors",children:[(0,g.jsx)(t.A,{className:"text-gray-400 mr-2",size:20}),(0,g.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Show Employees"})]}),(0,g.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-indigo-400 hover:bg-indigo-50 transition-colors",children:[(0,g.jsx)(x.A,{className:"text-gray-400 mr-2",size:20}),(0,g.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Create New User"})]})]})]}),(0,g.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,g.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,g.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Users (",S.length,")"]})}),s?(0,g.jsxs)("div",{className:"p-8 text-center",children:[(0,g.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,g.jsx)("p",{className:"text-gray-600",children:"Loading users..."})]}):i?(0,g.jsxs)("div",{className:"p-8 text-center",children:[(0,g.jsx)(u,{className:"mx-auto text-red-500 mb-4",size:48}),(0,g.jsx)("p",{className:"text-red-600",children:i}),(0,g.jsx)("button",{onClick:A,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]}):S.length>0?(0,g.jsx)("div",{className:"divide-y divide-gray-200",children:S.map(s=>(0,g.jsx)(y,{user:s,onRoleChange:a=>(async(s,a)=>{const t=e.find(e=>e._id===s),l=t?t.name:"User",o=prompt(`Why are you changing ${l}'s role to "${a}"?`);if(null!==o)try{const e=await fetch(`${b}/api/admin/users/${s}/role`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({role:a,reason:o||"No reason provided"})});if(e.ok){const t=await e.json();r(e=>e.map(e=>e._id===s?{...e,role:a}:e)),alert(`\u2705 Role updated successfully!\n\nUser: ${t.user.name}\nChanged from: ${t.change.from}\nChanged to: ${t.change.to}\nReason: ${t.change.reason}`)}else{const r=await e.json();alert(`\u274c Error: ${r.error}`)}}catch(n){console.error("Update role error:",n),alert("\u274c Failed to update role. Please try again.")}})(s._id,a)},s._id))}):(0,g.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-12 text-center",children:[(0,g.jsx)(m.A,{className:"mx-auto text-gray-400 mb-4",size:64}),(0,g.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Users Found"}),(0,g.jsx)("p",{className:"text-gray-600 mb-4",children:j||N?"Try adjusting your search criteria or filters.":"No users are currently registered in the system."}),(0,g.jsx)("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create First User"})]})]}),w&&(0,g.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex justify-center items-center p-4",children:(0,g.jsxs)("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,g.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New User"}),(0,g.jsx)("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:(0,g.jsx)(h.A,{size:24})})]})}),(0,g.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=new FormData(e.target),s=r.get("name"),a=r.get("email"),t=r.get("role"),l=r.get("password");try{const r=await fetch(`${b}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,email:a,password:l,role:t||"employee"})});if(r.ok){const s=await r.json();k(!1),A(),alert(`\u2705 User created successfully!\n\n\ud83d\udc64 Name: ${s.user.name}\n\ud83d\udce7 Email: ${s.user.email}\n\ud83c\udff7\ufe0f Role: ${s.user.role}`),e.target.reset()}else{const e=await r.json();alert(`\u274c Error: ${e.error}`)}}catch(o){console.error("Create user error:",o),alert("\u274c Failed to create user. Please try again.")}},className:"p-6 space-y-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"adminName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),(0,g.jsx)("input",{id:"adminName",type:"text",name:"name",required:!0,placeholder:"John Doe",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"adminEmail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,g.jsx)("input",{id:"adminEmail",type:"email",name:"email",required:!0,placeholder:"john.doe@company.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"adminRole",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),(0,g.jsxs)("select",{id:"adminRole",name:"role",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,g.jsx)("option",{value:"employee",children:"Employee"}),(0,g.jsx)("option",{value:"manager",children:"Manager"}),(0,g.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"adminPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,g.jsx)("input",{id:"adminPassword",type:"password",name:"password",required:!0,placeholder:"Enter password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,g.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,g.jsx)("button",{type:"button",onClick:()=>k(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,g.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create User"})]})]})]})})]})}},884:(e,r,s)=>{s.d(r,{A:()=>a});const a=(0,s(784).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])}}]);
//# sourceMappingURL=882.4694c71d.chunk.js.map